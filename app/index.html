<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fold - Privacy-Preserving DeFi Security</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            fold: {
              bg: '#0b0e14',
              card: 'rgba(255,255,255,0.05)',
              cyan: '#00EAFF',
              blue: '#2BAEDA',
              yellow: '#FBFB99',
              pink: '#FF3E8F',
            }
          }
        }
      }
    }
  </script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    body {
      font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Inter', 'Segoe UI', sans-serif;
      background: #0b0e14;
      color: #fff;
    }
    .mono { font-family: 'SF Mono', 'JetBrains Mono', monospace; }

    /* Cards */
    .fold-card {
      background: rgba(255,255,255,0.05);
      border-radius: 24px;
      overflow: hidden;
      position: relative;
    }
    .fold-card-glow::after {
      content: '';
      position: absolute;
      top: 94px;
      left: 50%;
      transform: translateX(-50%);
      width: 343px;
      height: 109px;
      background: radial-gradient(ellipse 171px 54px at center, rgba(136,212,255,0.15) 0%, transparent 100%);
      pointer-events: none;
    }

    /* Shield card with gradient glow */
    .shield-card {
      background: rgba(255,255,255,0.01);
      border-radius: 24px;
      overflow: hidden;
      position: relative;
    }

    /* Badges */
    .badge-healthy {
      display: inline-flex; align-items: center; justify-content: center;
      background: rgba(43,174,218,0.1); color: #00EAFF;
      font-size: 12px; font-weight: 500;
      padding: 12px; border-radius: 6px;
    }
    .badge-caution {
      display: inline-flex; align-items: center; justify-content: center;
      background: rgba(251,251,153,0.1); color: #FBFB99;
      font-size: 12px; font-weight: 500;
      padding: 12px; border-radius: 6px;
    }
    .badge-risk {
      display: inline-flex; align-items: center; justify-content: center;
      background: rgba(255,62,143,0.1); color: #FF3E8F;
      font-size: 12px; font-weight: 500;
      padding: 12px; border-radius: 6px;
    }

    /* Filter pills */
    .filter-pill {
      padding: 12px;
      border-radius: 12px;
      font-size: 15px;
      font-weight: 500;
      background: rgba(255,255,255,0.1);
      color: rgba(255,255,255,0.5);
      cursor: pointer;
      transition: all 0.15s;
      border: none;
    }
    .filter-pill.active {
      background: rgba(255,255,255,0.2);
      color: #fff;
    }

    /* Position rows */
    .position-row { transition: background 0.15s; border-radius: 12px; }
    .position-row:hover { background: rgba(255,255,255,0.03); }

    /* Action buttons */
    .action-btn {
      width: 40px; height: 40px;
      border-radius: 12px;
      display: inline-flex; align-items: center; justify-content: center;
      color: rgba(255,255,255,0.7);
      transition: all 0.15s;
      cursor: pointer; border: none; background: none;
      padding: 8px;
    }
    .action-btn:hover { background: rgba(255,255,255,0.05); }

    /* Health bars */
    .health-bar {
      border-radius: 50px;
      width: 10px;
      flex-shrink: 0;
    }
    .health-bar.healthy { background: rgba(43,174,218,0.4); }
    .health-bar.caution { background: rgba(251,251,153,0.7); }
    .health-bar.risk { background: rgba(255,0,106,0.7); }

    /* Footer bar */
    .footer-bar {
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      background: rgba(255,255,255,0.02);
      border-radius: 42px 42px 0 0;
    }

    /* Protocol icons */
    .protocol-icon {
      width: 32px; height: 32px;
      border-radius: 10px;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0;
      border: 2.5px solid;
      overflow: hidden;
    }
    .protocol-icon.kamino { background: #04182f; border-color: #caf2fc; }
    .protocol-icon.marginfi { background: #0f1110; border-color: #b5b5b5; }
    .protocol-icon.jupiter { background: #111727; border-color: #16c4e4; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-4px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes pulse-dot {
      0%, 100% { box-shadow: 0 0 0 0 rgba(0,234,255,0.4); }
      50% { box-shadow: 0 0 0 5px rgba(0,234,255,0); }
    }

    /* Encrypted grid pattern */
    .encrypt-grid {
      display: inline-grid;
      grid-template-columns: repeat(3, 32px);
      grid-template-rows: repeat(3, 32px);
      opacity: 0.1;
    }
  </style>
  <script src="https://unpkg.com/@solana/web3.js@1.98.0/lib/index.iife.min.js"></script>
  <script src="wallet.js"></script>
  <script src="program.js"></script>
</head>
<body class="min-h-screen flex flex-col">

  <!-- ═══════════ Navigation ═══════════ -->
  <nav class="px-[42px] py-[42px] flex items-center justify-between">
    <div class="flex items-center gap-[42px]">
      <!-- Logo + beta -->
      <div class="flex items-center gap-3">
        <!-- Fold logo SVG -->
        <svg width="90" height="22" viewBox="0 0 90 22" fill="none">
          <!-- Shield/fold icon -->
          <path d="M0 11C0 4.925 4.925 0 11 0C17.075 0 22 4.925 22 11C22 17.075 17.075 22 11 22C4.925 22 0 17.075 0 11Z" fill="#00EAFF" opacity="0.2"/>
          <path d="M7 8.5L11 6L15 8.5V13.5L11 16L7 13.5V8.5Z" stroke="#00EAFF" stroke-width="1.5" fill="none"/>
          <path d="M11 6V16M7 8.5L15 13.5M15 8.5L7 13.5" stroke="#00EAFF" stroke-width="0.75" opacity="0.5"/>
          <!-- "fold" text -->
          <text x="28" y="16" fill="white" font-family="'SF Pro Display',-apple-system,BlinkMacSystemFont,'Inter',sans-serif" font-weight="600" font-size="18" letter-spacing="-0.5">fold</text>
        </svg>
        <div class="flex items-center justify-center px-3 py-1.5 rounded-md" style="background:rgba(255,255,255,0.1);">
          <span style="font-size:15px;font-weight:500;color:rgba(255,255,255,0.5);">beta</span>
        </div>
      </div>
      <!-- Nav links -->
      <div class="flex items-center">
        <a href="index.html" class="px-6 py-3 text-[15px] font-medium text-white">Dashboard</a>
        <a href="activity.html" class="px-6 py-3 text-[15px] font-medium" style="color:rgba(255,255,255,0.6);">Activity</a>
        <a href="alerts.html" class="px-6 py-3 text-[15px] font-medium" style="color:rgba(255,255,255,0.6);">Alerts</a>
      </div>
    </div>
    <div class="flex items-center gap-3">
      <!-- Settings icon -->
      <a href="settings.html" style="color:rgba(255,255,255,0.5);">
        <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="3"/>
          <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/>
        </svg>
      </a>
      <!-- Connect button -->
      <button id="connect-btn" class="px-6 py-3 rounded-xl text-[15px] font-medium cursor-pointer transition-all" style="background:rgba(43,174,218,0.1);color:#00EAFF;border:none;" onmouseover="this.style.background='rgba(43,174,218,0.2)'" onmouseout="this.style.background='rgba(43,174,218,0.1)'">
        <span id="nav-wallet-addr">Connect</span>
      </button>
    </div>
  </nav>

  <!-- ═══════════ Main Content ═══════════ -->
  <main class="flex-1 px-[42px]">

    <!-- ── Positions Shield Status ── -->
    <div class="shield-card p-6 mb-2">
      <div class="flex items-start justify-between mb-16">
        <div class="flex flex-col gap-5">
          <h2 class="text-2xl font-medium text-white">Positions Shield Status</h2>
          <div class="flex items-center gap-3 text-[15px]">
            <span style="color:rgba(255,255,255,0.6);">Health over the past 90 days.</span>
            <a href="#" class="flex items-center" style="color:rgba(0,234,255,0.7);text-decoration:none;">
              View historical health.
              <svg width="24" height="24" fill="none" viewBox="0 0 24 24"><path d="M13 7l5 5-5 5M6 7l5 5-5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" opacity="0.7"/></svg>
            </a>
          </div>
        </div>
        <div class="text-right flex flex-col gap-5">
          <div class="text-2xl font-semibold" style="color:#00EAFF;">100%</div>
          <div class="text-[15px]" style="color:rgba(255,255,255,0.6);">Health Factor</div>
        </div>
      </div>
      <!-- 90-day bar chart -->
      <div id="health-chart" class="flex items-center justify-between w-full" style="height:50px;">
        <!-- Bars generated by JS -->
      </div>
    </div>

    <!-- ── Stats Row ── -->
    <div class="grid grid-cols-4 gap-6 py-8">
      <!-- Risk Checks Today -->
      <div class="fold-card fold-card-glow p-6">
        <div class="flex flex-col gap-5">
          <div id="stat-risk-checks" class="text-2xl font-medium text-white">—</div>
          <div class="text-[15px]" style="color:rgba(255,255,255,0.6);">Risk Checks Today (every 30s)</div>
        </div>
      </div>
      <!-- Threats Blocked -->
      <div class="fold-card fold-card-glow p-6">
        <div class="flex flex-col gap-5">
          <div class="text-2xl font-medium text-white">12</div>
          <div class="text-[15px]" style="color:rgba(255,255,255,0.6);">Threats Blocked</div>
        </div>
      </div>
      <!-- Protected Positions -->
      <div class="fold-card fold-card-glow p-6">
        <div class="flex flex-col gap-5">
          <div id="stat-position-count" class="text-2xl font-medium text-white">3</div>
          <div class="text-[15px]" style="color:rgba(255,255,255,0.6);">Protected Positions</div>
        </div>
      </div>
      <!-- Portfolio Value (Encrypted) -->
      <div class="fold-card fold-card-glow p-6 relative">
        <!-- Encrypted grid pattern -->
        <div class="encrypt-grid absolute top-6 left-6">
          <div class="size-8" style="background:#2BAEDA;"></div>
          <div class="size-8" style="background:rgba(43,174,218,0.5);"></div>
          <div class="size-8" style="background:rgba(43,174,218,0.25);"></div>
          <div class="size-8" style="background:rgba(43,174,218,0.5);"></div>
          <div class="size-8" style="background:rgba(43,174,218,0.5);"></div>
          <div class="size-8" style="background:rgba(43,174,218,0.25);"></div>
        </div>
        <div class="encrypt-grid absolute bottom-0 right-0 rotate-180">
          <div class="size-8" style="background:#2BAEDA;"></div>
          <div class="size-8" style="background:rgba(43,174,218,0.5);"></div>
          <div class="size-8" style="background:rgba(43,174,218,0.25);"></div>
          <div class="size-8" style="background:rgba(43,174,218,0.5);"></div>
          <div class="size-8" style="background:rgba(43,174,218,0.5);"></div>
          <div class="size-8" style="background:rgba(43,174,218,0.25);"></div>
        </div>
        <div class="flex flex-col gap-5 relative z-10">
          <div class="flex items-center gap-1 w-full">
            <span class="text-2xl font-medium text-white">Hidden from Agent</span>
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M14.167 8.333V6.667a4.167 4.167 0 00-8.334 0v1.666m2.084 4.584v1.25m4.166-1.25v1.25M5 8.333h10c.92 0 1.667.746 1.667 1.667v5.833c0 .92-.747 1.667-1.667 1.667H5c-.92 0-1.667-.746-1.667-1.667V10c0-.92.747-1.667 1.667-1.667z" stroke="#00EAFF" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </div>
          <div class="text-[15px]" style="color:rgba(255,255,255,0.6);">Portfolio Value</div>
        </div>
      </div>
    </div>

    <!-- ── Protected Positions Section ── -->
    <div class="mb-6">
      <!-- Section header -->
      <div class="px-6 mb-6">
        <h2 class="text-2xl font-medium text-white mb-5">Protected Positions</h2>
        <p class="text-[15px]" style="color:rgba(255,255,255,0.6);">Fold is actively monitoring your portfolio via encrypted computation</p>
      </div>

      <!-- Filters & Actions row -->
      <div class="flex items-center justify-between pl-6 mb-4">
        <div class="flex items-center gap-3" id="filter-pills">
          <button class="filter-pill active" data-filter="all">All</button>
          <button class="filter-pill" data-filter="healthy">Healthy (3)</button>
          <button class="filter-pill" data-filter="caution">Caution (1)</button>
          <button class="filter-pill" data-filter="critical">Critical (0)</button>
        </div>
        <div class="flex items-center gap-3 pl-6">
          <button class="flex items-center gap-2.5 p-3 rounded-xl text-[15px] font-medium cursor-pointer border-none" style="background:rgba(255,255,255,0.1);color:rgba(255,255,255,0.5);">
            <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="opacity:0.5;"><path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>
            Force Refresh
          </button>
          <button class="flex items-center gap-2.5 p-3 rounded-xl text-[15px] font-medium cursor-pointer border-none" style="background:rgba(43,174,218,0.1);color:#00EAFF;">
            <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14M5 12h14"/></svg>
            Add Position
          </button>
        </div>
      </div>

      <!-- Table Header -->
      <div class="fold-card w-full">
        <div class="flex items-center gap-3 pl-6 pr-[128px] py-6">
          <div class="w-[297px] text-[15px] font-normal" style="color:rgba(255,255,255,0.5);">Positions</div>
          <div class="w-[200px] px-3 text-[15px] font-normal" style="color:rgba(255,255,255,0.5);">Health</div>
          <div class="w-[187px] px-3 text-[15px] font-normal" style="color:rgba(255,255,255,0.5);">Last Check</div>
          <div class="px-3 text-[15px] font-normal text-center" style="color:rgba(255,255,255,0.5);">Protection</div>
        </div>
      </div>

      <!-- Position Rows -->
      <div id="positions-list" class="mt-2 space-y-1">
        <!-- Row 1: Kamino - Healthy -->
        <div class="position-row" data-health="healthy">
          <div class="flex items-center gap-3 p-3">
            <div class="flex items-center gap-6 w-[297px] h-[52px]">
              <div class="protocol-icon kamino">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none"><path d="M16 8L8 12v8l8 4 8-4v-8l-8-4z" fill="#C9F2FA"/><path d="M16 8v16M8 12l16 8M24 12L8 20" stroke="#C9F2FA" stroke-width="0.5"/></svg>
              </div>
              <div class="flex flex-col justify-between h-full py-1.5">
                <div class="text-[20px] font-medium text-white">Lending Position 1</div>
                <div class="text-[15px] font-medium" style="color:rgba(255,255,255,0.5);">Kamino</div>
              </div>
            </div>
            <div class="w-[200px]"><span class="badge-healthy">Healthy</span></div>
            <div class="w-[200px]"><span class="badge-healthy" style="background:transparent;color:rgba(255,255,255,0.7);">15s ago</span></div>
            <div class="flex-1"><span class="badge-healthy" style="background:transparent;color:#00EAFF;">Auto-Protect</span></div>
            <div class="flex items-center">
              <button class="action-btn" title="Pause"><svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 6v12M15 6v12"/></svg></button>
              <button class="action-btn" title="Refresh"><svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg></button>
              <button class="action-btn" title="Remove"><svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>
            </div>
          </div>
        </div>

        <!-- Row 2: MarginFi - Caution -->
        <div class="position-row" data-health="caution">
          <div class="flex items-center gap-3 p-3">
            <div class="flex items-center gap-6 w-[297px] h-[52px]">
              <div class="protocol-icon marginfi">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none"><path d="M16 6L6 26h20L16 6z" fill="#B5B5B5" opacity="0.5"/><path d="M16 12v8M16 22h.01" stroke="#B5B5B5" stroke-width="1.5"/></svg>
              </div>
              <div class="flex flex-col justify-between h-full py-1.5">
                <div class="text-[20px] font-medium text-white">Lending Position 2</div>
                <div class="text-[15px] font-medium" style="color:rgba(255,255,255,0.5);">MarginFi</div>
              </div>
            </div>
            <div class="w-[200px]"><span class="badge-caution">Caution</span></div>
            <div class="w-[200px]"><span class="badge-caution" style="background:transparent;color:rgba(255,255,255,0.7);">10s ago</span></div>
            <div class="flex-1"><span class="badge-caution" style="background:transparent;color:#00EAFF;">Auto-Protect</span></div>
            <div class="flex items-center">
              <button class="action-btn" title="Pause"><svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 6v12M15 6v12"/></svg></button>
              <button class="action-btn" title="Refresh"><svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg></button>
              <button class="action-btn" title="Remove"><svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>
            </div>
          </div>
        </div>

        <!-- Row 3: Jupiter - At Risk -->
        <div class="position-row" data-health="critical">
          <div class="flex items-center gap-3 p-3">
            <div class="flex items-center gap-6 w-[297px] h-[52px]">
              <div class="protocol-icon jupiter">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                  <path d="M9.35 2.96L2.97 13.92" stroke="url(#jg1)" stroke-width="1"/>
                  <path d="M4.68 2.96L11.06 13.92" stroke="url(#jg1)" stroke-width="1"/>
                  <path d="M7.02 0.5v13.5" stroke="url(#jg1)" stroke-width="1"/>
                  <defs><linearGradient id="jg1" x1="9.35" y1="2.96" x2="2.97" y2="13.92"><stop stop-color="#C7F284"/><stop offset="1" stop-color="#00BEF0"/></linearGradient></defs>
                </svg>
              </div>
              <div class="flex flex-col justify-between h-full py-1.5">
                <div class="text-[20px] font-medium text-white">LP Position 1</div>
                <div class="text-[15px] font-medium" style="color:rgba(255,255,255,0.5);">Jupiter</div>
              </div>
            </div>
            <div class="w-[200px]"><span class="badge-risk">At Risk</span></div>
            <div class="w-[200px]"><span class="badge-risk" style="background:transparent;color:rgba(255,255,255,0.7);">6s ago</span></div>
            <div class="flex-1"><span class="badge-risk" style="background:transparent;color:#00EAFF;">Auto-Protect</span></div>
            <div class="flex items-center">
              <button class="action-btn" title="Pause"><svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 6v12M15 6v12"/></svg></button>
              <button class="action-btn" title="Refresh"><svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg></button>
              <button class="action-btn" title="Remove"><svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- ═══════════ Footer Bar ═══════════ -->
  <footer class="footer-bar px-[42px] py-6 mt-auto">
    <div class="flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="flex items-center">
          <span class="px-3 py-1.5 text-[15px] font-medium" style="color:rgba(255,255,255,0.5);">built on</span>
          <!-- Solana text logo -->
          <span class="text-white text-[15px] font-semibold tracking-wide pr-3">SOLANA</span>
        </div>
        <div class="self-stretch flex items-center">
          <div style="width:2px;height:100%;background:rgba(217,217,217,0.2);"></div>
        </div>
        <div class="flex items-center">
          <span class="px-3 py-1.5 text-[15px] font-medium" style="color:rgba(255,255,255,0.5);">powered by</span>
          <!-- Arcium text logo -->
          <span class="text-white text-[15px] font-semibold tracking-wide pr-3">ARCIUM</span>
        </div>
      </div>
      <div class="flex items-center">
        <a href="#" class="px-6 py-3 text-[15px] font-medium" style="color:rgba(255,255,255,0.6);text-decoration:none;">Docs</a>
        <a href="https://github.com/ikeacrisp/fold-defi-agent" class="px-6 py-3 text-[15px] font-medium" style="color:rgba(255,255,255,0.6);text-decoration:none;">Github</a>
        <a href="#" class="px-6 py-3 text-[15px] font-medium" style="color:rgba(255,255,255,0.6);text-decoration:none;">Discord</a>
      </div>
    </div>
  </footer>

  <script>
    const HELIUS_RPC = 'https://devnet.helius-rpc.com/?api-key=10604451-ce29-4041-875d-88322f54ce98';
    const PROGRAM_ID_STR = 'ABDZr3DvUSnugBNrAj8vaAhKt3tHafA82MDja812QbJC';
    const AGENT_WALLET = '7XDzrqLP94yG3n26n8r6VU87gZ98FnF3tQFcm3a4tki7';
    let connection, programId;
    let riskChecksToday = 0;
    let lastSignature = null;

    // ═══ Generate 90-day health bar chart ═══
    (function() {
      const chart = document.getElementById('health-chart');
      for (let i = 0; i < 90; i++) {
        let status = 'healthy';
        // Create some variety: a few caution and risk days
        if (i === 18 || i === 19) status = 'caution';
        else if (i === 42) status = 'caution';
        else if (i >= 86 && i <= 87) { status = i === 86 ? 'caution' : 'risk'; }
        const bar = document.createElement('div');
        bar.className = 'health-bar ' + status;
        bar.style.height = '50px';
        bar.title = (90 - i) + ' days ago: ' + status.charAt(0).toUpperCase() + status.slice(1);
        chart.appendChild(bar);
      }
    })();

    // ═══ Filter pills ═══
    document.querySelectorAll('#filter-pills .filter-pill').forEach(pill => {
      pill.addEventListener('click', function() {
        document.querySelectorAll('#filter-pills .filter-pill').forEach(p => p.classList.remove('active'));
        this.classList.add('active');
        const filter = this.dataset.filter;
        document.querySelectorAll('#positions-list .position-row').forEach(row => {
          if (filter === 'all') row.style.display = '';
          else if (filter === 'healthy') row.style.display = row.dataset.health === 'healthy' ? '' : 'none';
          else if (filter === 'caution') row.style.display = row.dataset.health === 'caution' ? '' : 'none';
          else if (filter === 'critical') row.style.display = row.dataset.health === 'critical' ? '' : 'none';
        });
      });
    });

    // ═══ Tick timers ═══
    setInterval(() => {
      document.querySelectorAll('#positions-list .position-row').forEach(row => {
        const timeEl = row.querySelector('[style*="rgba(255,255,255,0.7)"]');
        if (timeEl) {
          const m = timeEl.textContent.match(/^(\d+)s ago$/);
          if (m) timeEl.textContent = (parseInt(m[1]) + 1) + 's ago';
        }
      });
    }, 1000);

    // ═══ Format relative time ═══
    function timeAgo(ts) {
      const diff = Math.floor(Date.now() / 1000) - ts;
      if (diff < 60) return diff + 's ago';
      if (diff < 3600) return Math.floor(diff / 60) + ' min ago';
      if (diff < 86400) return Math.floor(diff / 3600) + ' hour' + (Math.floor(diff / 3600) > 1 ? 's' : '') + ' ago';
      return Math.floor(diff / 86400) + ' day' + (Math.floor(diff / 86400) > 1 ? 's' : '') + ' ago';
    }

    // ═══ Fetch recent transactions from devnet ═══
    async function fetchRecentTxs() {
      try {
        const sigs = await connection.getSignaturesForAddress(programId, { limit: 25 });
        if (sigs.length === 0) return;
        const todayStart = new Date();
        todayStart.setHours(0, 0, 0, 0);
        const todayTs = Math.floor(todayStart.getTime() / 1000);
        let todayCount = 0;
        for (const sig of sigs) {
          if (sig.blockTime && sig.blockTime >= todayTs) todayCount++;
        }
        riskChecksToday = todayCount;
        document.getElementById('stat-risk-checks').textContent = riskChecksToday;
        lastSignature = sigs[0].signature;
      } catch (e) {
        console.error('Failed to fetch recent txs:', e);
      }
    }

    // ═══ Poll for new transactions ═══
    async function pollNewTxs() {
      try {
        const opts = { limit: 10 };
        if (lastSignature) opts.until = lastSignature;
        const sigs = await connection.getSignaturesForAddress(programId, opts);
        if (sigs.length > 0) {
          lastSignature = sigs[0].signature;
          riskChecksToday += sigs.length;
          document.getElementById('stat-risk-checks').textContent = riskChecksToday;
        }
      } catch (e) {
        console.error('Poll error:', e);
      }
    }

    // ═══ Subscribe to live on-chain events ═══
    function subscribeLiveEvents() {
      try {
        connection.onLogs(programId, (logs) => {
          if (logs.err) return;
          const logStr = logs.logs.join('\n');
          if (logStr.includes('HealthCheckCompleted')) {
            riskChecksToday++;
            document.getElementById('stat-risk-checks').textContent = riskChecksToday;
          }
        }, 'confirmed');
      } catch (e) {
        console.error('WebSocket subscription error:', e);
      }
    }

    // ═══ Init ═══
    (async function() {
      connection = new solanaWeb3.Connection(HELIUS_RPC, { commitment: 'confirmed', wsEndpoint: HELIUS_RPC.replace('https://', 'wss://') });
      programId = new solanaWeb3.PublicKey(PROGRAM_ID_STR);
      try {
        await FoldWallet.init();
        if (FoldWallet.isConnected() && FoldWallet.publicKey) {
          document.getElementById('nav-wallet-addr').textContent = FoldWallet.shortenAddress(FoldWallet.publicKey);
        }
      } catch(e) {
        console.log('Wallet not connected — showing read-only mode');
      }
      await fetchRecentTxs();
      subscribeLiveEvents();
      setInterval(pollNewTxs, 15000);
    })();
  </script>
</body>
</html>
